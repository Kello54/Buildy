<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>DIY Builder ‚Äî Phase 3</title>
<style>
  :root{
    --accent: #2e8b57; /* subtle green for cheapest highlight */
    --accent-soft: rgba(46,139,87,0.08);
    --gold: #b8860b;
    --bg-overlay: rgba(0,0,0,0.45);
    --card-bg: rgba(255,255,255,0.95);
    --muted: #6b7280;
    --max-width: 1100px;
    --radius: 8px;
  }

  html,body{height:100%;margin:0;font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;}
  body{
    background-image: url('images/construction-bg.jpg'); /* <-- change your background here */
    background-size: cover;
    background-position: center;
    color:#111;
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
  }

  /* hero overlay to keep text readable */
  .overlay {
    background: linear-gradient(180deg, rgba(0,0,0,0.22), rgba(0,0,0,0.38));
    min-height: 220px;
    display:flex;
    align-items:center;
    justify-content:center;
    padding:28px;
    color:white;
  }
  .hero {
    width:100%;
    max-width:var(--max-width);
    margin:0 auto;
    display:flex;
    justify-content:space-between;
    align-items:center;
    gap:12px;
  }
  .logo{
    display:flex;
    gap:12px;
    align-items:center;
  }
  .logo img{height:56px; border-radius:6px; background:rgba(255,255,255,0.12); padding:6px;}
  .hero h1{margin:0;font-size:22px;letter-spacing:0.2px;}
  .hero p{margin:0;color:rgba(255,255,255,0.85); font-size:13px;}

  /* main app container */
  .app {
    max-width: var(--max-width);
    margin: -60px auto 60px; /* pull up over hero */
    padding: 18px;
    box-sizing:border-box;
  }

  .card{
    background: var(--card-bg);
    border-radius: var(--radius);
    box-shadow: 0 8px 30px rgba(2,6,23,0.12);
    padding:16px;
    margin-bottom:16px;
    overflow:visible;
  }

  /* search & controls */
  .controls{
    display:flex;
    gap:12px;
    flex-wrap:wrap;
    align-items:center;
  }
  .search {
    flex:1 1 420px;
    display:flex;
    gap:8px;
    align-items:center;
  }
  .search input{
    flex:1;
    padding:10px 12px;
    border-radius:8px;
    border:1px solid #e6e6e8;
    font-size:14px;
  }
  .filters{
    display:flex;
    gap:8px;
    flex-wrap:wrap;
  }
  .filters button{
    padding:8px 12px;border-radius:999px;border:1px solid #eee;background:#fff;font-size:13px;cursor:pointer;
  }
  .filters button.active{border-color:var(--gold); box-shadow: 0 2px 8px rgba(184,134,11,0.08);}

  /* stats / small controls */
  .meta{
    display:flex;
    gap:12px;
    align-items:center;
  }
  .badge{
    display:inline-flex;
    gap:8px;
    align-items:center;
    padding:8px 10px;
    border-radius:999px;
    background:rgba(0,0,0,0.04);
    font-size:13px;
  }

  /* accordion categories */
  .accordion{
    margin-top:12px;
  }
  .category{
    margin-bottom:10px;
    border-radius:8px;
    overflow:hidden;
    border:1px solid rgba(0,0,0,0.06);
  }
  .category-header{
    display:flex;
    justify-content:space-between;
    align-items:center;
    padding:12px 14px;
    background:linear-gradient(180deg, rgba(255,255,255,0.98), rgba(250,250,250,0.96));
    cursor:pointer;
  }
  .category-header h3{margin:0;font-size:15px;}
  .category-body{padding:12px 14px;border-top:1px solid rgba(0,0,0,0.04);}

  /* product table */
  table{width:100%;border-collapse:collapse;font-size:14px;}
  th,td{padding:10px 8px;text-align:left;border-bottom:1px dashed rgba(0,0,0,0.06);}
  th{font-weight:600;font-size:13px;color:var(--muted);}
  .prod-name{min-width:180px;font-weight:600;}
  .supplier-cell{min-width:120px;}
  .cheapest{background:linear-gradient(90deg,var(--accent-soft),transparent);border-radius:6px;}
  .price{font-weight:700;}
  .small{font-size:12px;color:var(--muted);}

  /* action buttons */
  .btn{
    padding:8px 10px;border-radius:8px;border:0;cursor:pointer;font-weight:600;
  }
  .btn-green{background:var(--accent);color:white;}
  .btn-outline{background:transparent;border:1px solid rgba(0,0,0,0.08);}

  /* supplier column with contact icons */
  .supplier-meta{
    display:flex;
    gap:8px;
    align-items:center;
  }
  .supplier-meta img{height:28px;width:28px;object-fit:contain;border-radius:6px;background:#fff;padding:4px;border:1px solid rgba(0,0,0,0.04);}

  /* cart/wishlist floating */
  .floating {
    position:fixed;
    right:18px;
    bottom:18px;
    z-index:1400;
    display:flex;
    flex-direction:column;
    gap:10px;
  }
  .floating button{
    display:flex;
    gap:10px;
    align-items:center;
    padding:10px 12px;
    border-radius:999px;
    border:0;
    box-shadow: 0 8px 24px rgba(2,6,23,0.12);
    background:rgba(255,255,255,0.98);
    cursor:pointer;
    font-weight:600;
  }
  .floating .count{
    background:var(--gold);
    color:white;padding:6px 8px;border-radius:999px;font-weight:700;font-size:13px;
  }

  /* responsive */
  @media (max-width:880px){
    .hero h1{font-size:18px;}
    .logo img{height:46px;}
    th,td{font-size:13px;padding:8px 6px;}
    .app{margin: -40px 12px 60px;}
  }
  @media (max-width:560px){
    .controls{flex-direction:column;align-items:stretch;}
    .search input{font-size:14px;padding:9px;}
    table{font-size:13px;}
    .supplier-cell{display:flex;flex-direction:column;gap:6px;}
  }

  footer{max-width:var(--max-width);margin:24px auto;color:var(--muted);font-size:13px;padding:0 16px;}
</style>
</head>
<body>
  <div class="overlay" role="banner" aria-label="Hero">
    <div class="hero" >
      <div class="logo">
        <img src="images/logo-placeholder.png" alt="DIY Builder logo" />
        <div>
          <h1>DIY Builder ‚Äî Price Compare</h1>
          <p>Phase 3 ‚Äî Search, filter, compare & save. Background kept as requested.</p>
        </div>
      </div>

      <div style="display:flex;gap:8px;align-items:center;">
        <div style="text-align:right;color:rgba(255,255,255,0.9);">
          <div style="font-weight:700">Project: Home Extension</div>
          <div style="font-size:13px;opacity:0.9">Ireland ‚Ä¢ Materials pricing</div>
        </div>
      </div>
    </div>
  </div>

  <main class="app" role="main" aria-labelledby="app-title">
    <section class="card" id="controls-card">
      <div style="display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap;">
        <div style="flex:1 1 60%;">
          <div class="controls">
            <div class="search" role="search" aria-label="Search products">
              <input id="searchInput" placeholder="Search products, brands or codes..." aria-label="Search products" />
              <button id="clearSearch" class="btn btn-outline" title="Clear">Clear</button>
            </div>

            <div class="filters" role="toolbar" aria-label="Category filters">
              <button class="filter-btn active" data-cat="all">All</button>
              <button class="filter-btn" data-cat="timber">Timber</button>
              <button class="filter-btn" data-cat="cement">Cement & Aggregates</button>
              <button class="filter-btn" data-cat="paint">Paint & Finishes</button>
              <button class="filter-btn" data-cat="tools">Tools & Fixings</button>
            </div>
          </div>
        </div>

        <div class="meta">
          <div class="badge">Suppliers: <strong style="margin-left:6px">Chadwicks ‚Ä¢ Woodies ‚Ä¢ Buckley</strong></div>
          <div class="badge">Mode: <span class="small" style="margin-left:6px">Comparison (local)</span></div>
        </div>
      </div>
    </section>

    <section class="card">
      <div style="display:flex;justify-content:space-between;align-items:center;">
        <h2 id="app-title" style="margin:0;font-size:16px">Products & Price Comparison</h2>
        <div class="small">Tap a category to expand. Cheapest price is highlighted.</div>
      </div>

      <div class="accordion" id="accordionRoot" aria-live="polite">
        <!-- categories render here -->
      </div>
    </section>

    <section class="card" id="saved-card" aria-live="polite">
      <h3 style="margin:0 0 8px 0">Saved / Quick Cart</h3>
      <div id="quickSummary" class="small">You have <strong id="wishlistCount">0</strong> saved items and <strong id="cartCount">0</strong> items in cart.</div>
      <div style="margin-top:12px;">
        <button id="viewCart" class="btn btn-green">View Cart</button>
        <button id="clearAll" class="btn btn-outline">Clear Cart & Wishlist</button>
        <div id="cartPreview" style="margin-top:12px;"></div>
      </div>
    </section>

  </main>

  <div class="floating" aria-hidden="false">
    <button id="goWishlist" title="Wishlist / Saved">
      ‚ô• Saved <span id="wishBadge" class="count">0</span>
    </button>
    <button id="goCart" title="Cart">
      üõí Cart <span id="cartBadge" class="count">0</span>
    </button>
  </div>

  <footer>
    Tip: change the hero background at the top of the CSS `body { background-image: url(...) }` line.
  </footer>

<script>
/* --------------------------
   Sample product dataset
   (Replace / extend with live data later)
   -------------------------- */
const suppliers = [
  { id: 'chadwicks', name:'Chadwicks', phone:'+35312345601', website:'https://chadwicks.example', logo:'images/chadwicks.png' },
  { id: 'woodies',   name:'Woodies',   phone:'+35312345602', website:'https://woodies.example', logo:'images/woodies.png' },
  { id: 'buckley',   name:'Buckley',   phone:'+35312345603', website:'https://buckley.example', logo:'images/buckley.png' }
];

const products = [
  /* Timber category */
  { id:'t1', name:'Pressure Treated 2x4 Timber (3m)', cat:'timber', sku:'T-2X4-3M', prices:{ chadwicks:19.49, woodies:20.10, buckley:18.95 }},
  { id:'t2', name:'Plywood 12mm (2440x1220)', cat:'timber', sku:'PLY-12-2440', prices:{ chadwicks:35.90, woodies:34.75, buckley:36.00 }},
  /* Cement & Aggregates */
  { id:'c1', name:'Portland Cement 25kg', cat:'cement', sku:'CEM-25', prices:{ chadwicks:8.50, woodies:8.95, buckley:8.30 }},
  { id:'c2', name:'Sharp Sand (per tonne)', cat:'cement', sku:'SAND-1T', prices:{ chadwicks:42.00, woodies:40.50, buckley:41.20 }},
  /* Paint & Finishes */
  { id:'p1', name:'Exterior Masonry Paint 10L', cat:'paint', sku:'PAINT-MEX-10', prices:{ chadwicks:79.99, woodies:75.50, buckley:78.00 }},
  { id:'p2', name:'Primer Undercoat 5L', cat:'paint', sku:'PRIM-5L', prices:{ chadwicks:32.50, woodies:30.99, buckley:31.49 }},
  /* Tools & Fixings */
  { id:'s1', name:'50mm Timber Screws (Box 200)', cat:'tools', sku:'SCREW-50-200', prices:{ chadwicks:14.99, woodies:15.50, buckley:13.95 }},
  { id:'s2', name:'Cordless Drill (18V)', cat:'tools', sku:'DRILL-18V', prices:{ chadwicks:89.99, woodies:85.00, buckley:92.00 }},
];

/* --------------------------
   Local storage helpers (cart & wishlist)
   -------------------------- */
const LS_CART = 'phase3_cart_v1';
const LS_WISH = 'phase3_wish_v1';

function loadCart(){ try { return JSON.parse(localStorage.getItem(LS_CART)) || {}; } catch(e){ return {}; } }
function loadWish(){ try { return JSON.parse(localStorage.getItem(LS_WISH)) || {}; } catch(e){ return {}; } }
function saveCart(obj){ localStorage.setItem(LS_CART, JSON.stringify(obj)); }
function saveWish(obj){ localStorage.setItem(LS_WISH, JSON.stringify(obj)); }

let cart = loadCart();
let wish = loadWish();

/* --------------------------
   Render logic
   -------------------------- */
const accordionRoot = document.getElementById('accordionRoot');

function groupByCategory(items){
  const map = {};
  items.forEach(p=>{
    if(!map[p.cat]) map[p.cat]=[];
    map[p.cat].push(p);
  });
  return map;
}

function renderCategories(filterCat='all', query=''){
  accordionRoot.innerHTML='';
  const grouped = groupByCategory(products);
  const order = ['timber','cement','paint','tools'];
  const names = {
    timber:'Timber',
    cement:'Cement & Aggregates',
    paint:'Paint & Finishes',
    tools:'Tools & Fixings'
  };

  order.forEach(cat=>{
    if(filterCat!=='all' && filterCat!==cat) return;
    const list = grouped[cat] || [];
    const filtered = list.filter(p => {
      if(!query) return true;
      const q = query.toLowerCase();
      return (p.name||'').toLowerCase().includes(q) || (p.sku||'').toLowerCase().includes(q);
    });
    if(filtered.length===0) return;

    const catEl = document.createElement('div');
    catEl.className='category';
    const header = document.createElement('div');
    header.className='category-header';
    header.setAttribute('role','button');
    header.setAttribute('aria-expanded','false');
    header.innerHTML = \`
      <div>
        <h3>\${names[cat] || cat}</h3>
        <div class="small" style="margin-top:4px;color:var(--muted)">\${filtered.length} item(s)</div>
      </div>
      <div style="display:flex;gap:10px;align-items:center">
        <div class="small">Tap to expand</div>
        <div style="font-size:18px;transform:rotate(90deg)">‚ùØ</div>
      </div>
    \`;
    const body = document.createElement('div');
    body.className='category-body';
    body.style.display='none';

    body.appendChild(renderTableFor(filtered));

    header.addEventListener('click', () => {
      const expanded = header.getAttribute('aria-expanded') === 'true';
      header.setAttribute('aria-expanded', String(!expanded));
      body.style.display = expanded ? 'none' : 'block';
    });

    catEl.appendChild(header);
    catEl.appendChild(body);
    accordionRoot.appendChild(catEl);
  });
}

/* build a price table per category */
function renderTableFor(list){
  const wrapper = document.createElement('div');
  wrapper.style.overflowX = 'auto';
  const table = document.createElement('table');
  table.setAttribute('role','table');
  const thead = document.createElement('thead');
  const headerRow = document.createElement('tr');

  headerRow.innerHTML = \`
    <th>Product</th>
    <th class="small">SKU</th>
    \${suppliers.map(s => '<th>'+s.name+'</th>').join('')}
    <th style="min-width:130px">Actions</th>
  \`;
  thead.appendChild(headerRow);
  table.appendChild(thead);

  const tbody = document.createElement('tbody');

  list.forEach(prod=>{
    // determine cheapest supplier(s)
    const entries = suppliers.map(s => ({ id:s.id, price: prod.prices[s.id] ?? null }));
    const valid = entries.filter(e => e.price !== null && !Number.isNaN(e.price));
    let min = null;
    if(valid.length) min = Math.min(...valid.map(e=>e.price));

    const row = document.createElement('tr');

    const nameCell = document.createElement('td');
    nameCell.className='prod-name';
    nameCell.innerHTML = '<div>'+prod.name+'</div><div class="small">'+(prod.cat)+' </div>';
    row.appendChild(nameCell);

    const skuCell = document.createElement('td');
    skuCell.className='small';
    skuCell.textContent = prod.sku || '-';
    row.appendChild(skuCell);

    suppliers.forEach(s=>{
      const td = document.createElement('td');
      td.className='supplier-cell';
      const price = prod.prices[s.id];
      if(price === undefined || price === null){
        td.innerHTML = '<div class="small">‚Äî</div>';
      } else {
        const cheapestClass = (min !== null && price === min) ? 'cheapest' : '';
        td.innerHTML = \`
          <div class="\${cheapestClass}" style="padding:6px;border-radius:6px;display:flex;justify-content:space-between;align-items:center">
            <div style="display:flex;gap:8px;align-items:center;">
              <img src="\${s.logo}" alt="\${s.name} logo" style="height:28px;width:28px;object-fit:contain;border-radius:6px" onerror="this.style.display='none'"/>
              <div>
                <div class="price">‚Ç¨\${price.toFixed(2)}</div>
                <div class="small">per unit</div>
              </div>
            </div>
            <div style="display:flex;flex-direction:column;gap:6px;align-items:flex-end">
              <a href="tel:\${s.phone}" class="small" title="Call \${s.name}">Call</a>
              <a href="\${s.website}" target="_blank" rel="noopener" class="small">Visit</a>
            </div>
          </div>
        \`;
      }
      row.appendChild(td);
    });

    // actions
    const actionTd = document.createElement('td');
    actionTd.style.display='flex';
    actionTd.style.gap='8px';
    actionTd.style.alignItems='center';

    const addBtn = document.createElement('button');
    addBtn.className='btn btn-outline';
    addBtn.textContent='Add to Cart';
    addBtn.addEventListener('click', ()=> {
      addToCart(prod.id);
    });

    const wishBtn = document.createElement('button');
    wishBtn.className='btn';
    wishBtn.textContent = wish[prod.id] ? 'Saved' : 'Save';
    wishBtn.addEventListener('click', ()=>{
      toggleWish(prod.id);
      wishBtn.textContent = wish[prod.id] ? 'Saved' : 'Save';
    });

    actionTd.appendChild(addBtn);
    actionTd.appendChild(wishBtn);
    row.appendChild(actionTd);

    tbody.appendChild(row);
  });

  table.appendChild(tbody);
  wrapper.appendChild(table);
  return wrapper;
}

/* --------------------------
   Interaction helpers
   -------------------------- */

function addToCart(prodId){
  cart[prodId] = (cart[prodId] || 0) + 1;
  saveCart(cart);
  updateBadges();
  renderCartPreview();
  toast('Added to cart');
}

function toggleWish(prodId){
  if(wish[prodId]) delete wish[prodId];
  else wish[prodId] = { savedAt: Date.now() };
  saveWish(wish);
  updateBadges();
  renderCartPreview();
}

function updateBadges(){
  const wishCount = Object.keys(wish).length;
  const cartCount = Object.values(cart).reduce((a,b)=>a+b,0);
  document.getElementById('wishBadge').textContent = wishCount;
  document.getElementById('cartBadge').textContent = cartCount;
  document.getElementById('wishlistCount').textContent = wishCount;
  document.getElementById('cartCount').textContent = cartCount;
}

/* cart preview */
function renderCartPreview(){
  const el = document.getElementById('cartPreview');
  el.innerHTML = '';
  const cartItems = Object.keys(cart);
  if(cartItems.length===0 && Object.keys(wish).length===0){
    el.innerHTML = '<div class="small">No saved items or cart items yet.</div>';
    return;
  }
  if(cartItems.length){
    const title = document.createElement('div');
    title.innerHTML = '<strong>Cart</strong>';
    el.appendChild(title);
    cartItems.forEach(pid=>{
      const prod = products.find(p=>p.id===pid);
      if(!prod) return;
      const row = document.createElement('div');
      row.style.display='flex'; row.style.justifyContent='space-between'; row.style.gap='8px'; row.style.padding='6px 0';
      row.innerHTML = \`<div>\${prod.name} <div class="small">x\${cart[pid]}</div></div><div class="small">‚Ç¨\${minPrice(prod).toFixed(2)} ea</div>\`;
      el.appendChild(row);
    });
    const checkout = document.createElement('div');
    checkout.style.marginTop='8px';
    checkout.innerHTML = '<button id="exportCart" class="btn btn-green">Export Cart (CSV)</button>';
    el.appendChild(checkout);
    document.getElementById('exportCart').addEventListener('click', exportCartCSV);
  }

  const wishKeys = Object.keys(wish);
  if(wishKeys.length){
    const title = document.createElement('div');
    title.innerHTML = '<strong style="margin-top:8px;display:block">Saved</strong>';
    el.appendChild(title);
    wishKeys.forEach(pid=>{
      const prod = products.find(p=>p.id===pid);
      if(!prod) return;
      const row = document.createElement('div');
      row.style.display='flex'; row.style.justifyContent='space-between'; row.style.gap='8px'; row.style.padding='6px 0';
      row.innerHTML = \`<div>\${prod.name}</div><div><button class="btn btn-outline" data-id="\${pid}" onclick="addFromPreview('\${pid}')">Add</button></div>\`;
      el.appendChild(row);
    });
  }
}

function addFromPreview(pid){
  addToCart(pid);
}

/* quick utility to find min price */
function minPrice(prod){
  const vals = Object.values(prod.prices).filter(v=>typeof v==='number' && !Number.isNaN(v));
  return vals.length ? Math.min(...vals) : 0;
}

/* export cart as CSV (simple) */
function exportCartCSV(){
  const rows = [['SKU','Product','Qty','UnitPriceEUR','SupplierOfUnitPrice']];
  Object.keys(cart).forEach(pid=>{
    const prod = products.find(p=>p.id===pid);
    if(!prod) return;
    // pick cheapest supplier
    let chosenSupplier = null;
    let chosenPrice = Number.POSITIVE_INFINITY;
    suppliers.forEach(s=>{
      const p = prod.prices[s.id];
      if(typeof p === 'number' && p < chosenPrice){ chosenPrice = p; chosenSupplier = s.name; }
    });
    rows.push([prod.sku || '', prod.name, cart[pid], chosenPrice.toFixed(2), chosenSupplier || '']);
  });
  const csv = rows.map(r => r.map(c => '\"'+String(c).replace(/\"/g,'\"\"')+'\"').join(',')).join('\\n');
  const blob = new Blob([csv], { type: 'text/csv' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = 'cart_export.csv';
  document.body.appendChild(a);
  a.click();
  a.remove();
  URL.revokeObjectURL(url);
}

/* toast notifications (simple) */
let toastTimer = null;
function toast(msg){
  const t = document.createElement('div');
  t.textContent = msg;
  t.style.position = 'fixed';
  t.style.left = '50%';
  t.style.transform = 'translateX(-50%)';
  t.style.bottom = '24px';
  t.style.padding = '10px 16px';
  t.style.background = 'rgba(0,0,0,0.8)';
  t.style.color = 'white';
  t.style.borderRadius = '999px';
  t.style.zIndex = 2200;
  document.body.appendChild(t);
  clearTimeout(toastTimer);
  toastTimer = setTimeout(()=>{ t.remove(); }, 2000);
}

/* --------------------------
   Filtering & events
   -------------------------- */
document.querySelectorAll('.filter-btn').forEach(btn=>{
  btn.addEventListener('click', ()=>{
    document.querySelectorAll('.filter-btn').forEach(b=>b.classList.remove('active'));
    btn.classList.add('active');
    const cat = btn.getAttribute('data-cat');
    const q = document.getElementById('searchInput').value.trim();
    renderCategories(cat, q);
  });
});

document.getElementById('searchInput').addEventListener('input', (e)=>{
  const q = e.target.value.trim();
  const active = document.querySelector('.filter-btn.active')?.getAttribute('data-cat') || 'all';
  renderCategories(active, q);
});

document.getElementById('clearSearch').addEventListener('click', ()=>{
  document.getElementById('searchInput').value = '';
  const active = document.querySelector('.filter-btn.active')?.getAttribute('data-cat') || 'all';
  renderCategories(active, '');
});

/* floating buttons */
document.getElementById('goWishlist').addEventListener('click', ()=>{
  document.querySelector('.filter-btn[data-cat="all"]').click();
  toast('Opened wishlist section (scroll down).');
});
document.getElementById('goCart').addEventListener('click', ()=>{
  document.getElementById('viewCart').click();
  toast('Opened cart preview.');
});

document.getElementById('viewCart').addEventListener('click', ()=>{
  // simple toggle of quick summary visibility
  const el = document.getElementById('cartPreview');
  el.style.display = el.style.display==='block' ? 'none' : 'block';
});

document.getElementById('clearAll').addEventListener('click', ()=>{
  if(confirm('Clear cart and saved items?')) {
    cart = {}; wish = {};
    saveCart(cart); saveWish(wish);
    updateBadges(); renderCartPreview();
  }
});

/* export helper used earlier (global) */
window.addFromPreview = function(pid){
  addFromPreview(pid);
}

/* --------------------------
   Init
   -------------------------- */
(function init(){
  // ensure supplier images placeholders exist (if not they'll hide)
  // initial render
  renderCategories('all','');
  updateBadges();
  renderCartPreview();

  // accessibility: expand first category by default
  const firstHeader = document.querySelector('.category .category-header');
  if(firstHeader) firstHeader.click();
})();
</script>
</body>
</html>
