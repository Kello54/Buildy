<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Buildy - No.1 Building Material Price Comparison</title>
<link rel="icon" href="https://kello54.github.io/Buildy/docs/images/favicon.png" type="image/png">
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">
<style>
/* keep your styling exactly as you had it */
:root {
  --primary-color: #4b3c7a;
  --secondary-color: #6f5abf;
  --accent-color: #f5c359;
  --bg-color: #f8f7fa;
  --text-color: #222;
  --button-hover: #362b5c;
  --hero-overlay: rgba(0,0,0,0.3);
}
body { font-family: 'Montserrat', sans-serif; margin:0; background:var(--bg-color); color:var(--text-color); }
/* header, hero, table, map, dashboard styling stays same */
</style>
</head>
<body>

<header>
  <div class="header-left">
    <img src="https://kello54.github.io/Buildy/docs/images/logo.png" alt="Buildy Logo" class="logo">
    <span class="brand-name">Buildy</span>
  </div>
  <div class="header-right">
    <button id="loginBtn" class="login-btn">Login</button>
  </div>
</header>

<nav class="sub-header">
  <a href="#">Home</a>
  <a href="#">Compare Materials</a>
  <a href="#">Suppliers</a>
</nav>

<section class="hero">
  <h1>No.1 building material price comparison website</h1>
  <p>Quickly find the cheapest prices across multiple suppliers</p>
  <input type="text" id="searchInput" placeholder="Enter material...">
  <button id="downloadCSV">Start Comparing</button>
</section>

<section class="comparison">
  <table id="materialsTable">
    <thead><tr id="tableHead"></tr></thead>
    <tbody id="tableBody"></tbody>
  </table>
</section>

<section id="map"></section>

<section class="features">
  <div class="feature"><h3>Select Material</h3><p>Search or browse materials you need to purchase.</p></div>
  <div class="feature"><h3>Compare Prices</h3><p>See prices from multiple suppliers at a glance.</p></div>
  <div class="feature"><h3>Choose Supplier</h3><p>Select the cheapest or most convenient supplier for your order.</p></div>
</section>

<section id="dashboard">
  <h2 style="text-align:center; color: var(--primary-color);">Dashboard</h2>
  <div class="dashboard-cards">
    <div class="card" id="welcomeCard"><h3>Welcome!</h3><p>Hello, user!</p></div>
    <div class="card" id="recentSearchesCard"><h3>Recent Searches</h3><ul id="recentSearches"></ul></div>
    <div class="card" id="savedComparisonsCard"><h3>Saved Comparisons</h3><ul id="savedComparisons"></ul></div>
    <div class="card" id="statsCard"><h3>Stats</h3><p id="statsContent">No comparisons yet</p></div>
    <div class="card"><h3>Export</h3><button id="exportDashboard">Download CSV</button></div>
    <div class="card"><h3>Navigation</h3><button id="backToCompare" style="background:var(--primary-color);color:#fff;padding:8px 14px;border:none;border-radius:6px;cursor:pointer;">Back to Comparison</button></div>
  </div>
</section>

<footer>
  &copy; 2025 Buildy | Compare building materials quickly and easily
  <div style="margin-top:10px;">
    <a href="#">About</a>
    <a href="#">Contact</a>
  </div>
</footer>

<!-- Login Modal -->
<div id="loginModal" class="modal">
  <div class="modal-content">
    <span class="close">&times;</span>
    <h2>Login</h2>
    <input type="text" id="username" placeholder="Username">
    <input type="password" id="password" placeholder="Password">
    <button id="submitLogin">Login</button>
  </div>
</div>

<script>
// Hero fade-in
window.addEventListener('load', ()=> document.querySelector('.hero').classList.add('loaded'));

// Suppliers (only 4)
const suppliers = [
  {name:"TJ O'Mahony", lat:53.338,lng:-6.30},
  {name:"Chadwick's", lat:53.34,lng:-6.27},
  {name:"JJ Bolgers", lat:53.345,lng:-6.28},
  {name:"Woodie's", lat:53.336,lng:-6.29}
];

// Build table header
const headRow = document.getElementById("tableHead");
headRow.innerHTML = "<th>Material</th>" + suppliers.map(s=>`<th>${s.name}</th>`).join("");

// Load materials from prices.json
async function loadMaterials(){
  try {
    const res = await fetch("prices.json");
    const data = await res.json();
    const body = document.getElementById("tableBody");
    body.innerHTML = "";
    Object.entries(data).forEach(([material, supplierPrices])=>{
      const row = document.createElement("tr");
      let prices = suppliers.map(s => supplierPrices[s.name] || null);
      let cheapest = Math.min(...prices.filter(p=>p!==null));
      row.innerHTML = `
        <td>${material}</td>
        ${suppliers.map(s=>{
          let price = supplierPrices[s.name];
          if(price===undefined) return "<td>N/A</td>";
          return `<td class="${price===cheapest ? 'cheapest' : ''}">â‚¬${price.toFixed(2)}</td>`;
        }).join("")}
      `;
      body.appendChild(row);
    });
  } catch(err){
    console.error("Failed to load prices.json", err);
  }
}
loadMaterials();

// Search filter
document.getElementById("searchInput").addEventListener("input", e=>{
  const filter = e.target.value.toLowerCase();
  document.querySelectorAll("#tableBody tr").forEach(row=>{
    row.style.display = row.cells[0].textContent.toLowerCase().includes(filter) ? "" : "none";
  });
});

// CSV Export
document.getElementById("downloadCSV").onclick=()=>{
  let csv="Material,"+suppliers.map(s=>s.name).join(",")+"\n";
  document.querySelectorAll("#tableBody tr").forEach(row=>{
    let cols = Array.from(row.cells).map(c=>c.textContent);
    csv += cols.join(",") + "\n";
  });
  const blob = new Blob([csv],{type:"text/csv"});
  const url = URL.createObjectURL(blob);
  let a=document.createElement("a");
  a.href=url; a.download="prices.csv"; a.click();
  URL.revokeObjectURL(url);
};

// Google Map
function initMap(){
  const map = new google.maps.Map(document.getElementById("map"), {zoom:12, center:{lat:53.338,lng:-6.29}});
  suppliers.forEach((s,i)=>{
    let marker=new google.maps.Marker({
      position:{lat:s.lat,lng:s.lng}, map, title:s.name,
      animation:google.maps.Animation.DROP, icon:"http://maps.google.com/mapfiles/ms/icons/purple-dot.png"
    });
    let info=new google.maps.InfoWindow({content:`<strong>${s.name}</strong>`});
    marker.addListener("click", ()=>info.open(map, marker));
    setTimeout(()=>marker.setMap(map), i*200);
  });
}
</script>
<script async defer src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&callback=initMap"></script>
</body>
</html>
